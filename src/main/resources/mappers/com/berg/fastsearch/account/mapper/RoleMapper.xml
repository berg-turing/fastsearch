<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.berg.fastsearch.account.mapper.RoleMapper">
    <!-- 表名 -->
    <sql id="TableName">
        SYS_ROLES AS ${alias}
    </sql>

    <!-- 基础ResultMap -->
    <resultMap id="BaseResultMap" type="com.berg.fastsearch.account.entity.Role">
        <id column="ID" property="id" jdbcType="BIGINT" />
        <result column="NAME" property="name" jdbcType="VARCHAR" />
        <result column="DESCRIPTION" property="description" jdbcType="VARCHAR" />
    </resultMap>

    <!-- 基础Sql -->
    <sql id="BaseSql">
        ${prefix}.ID,
        ${prefix}.NAME,
        ${prefix}.DESCRIPTION
    </sql>

    <!-- 基本的查询条件 -->
    <sql id="BaseCondition">
        <if test="id!=null and id!=0">
            AND ${prefix}.ID = #{id, jdbcType=DECIMAL}
        </if>
        <if test="name!=null and !('').equals(name.trim())">
            AND ${prefix}.NAME LIKE CONCAT('%', CONCAT(#{name, jdbcType=VARCHAR}, '%'))
        </if>
        <if test="description!=null and !('').equals(description)">
            AND ${prefix}.DESCRIPTION LIKE CONCAT('%', CONCAT(#{description.trim(), jdbcType=VARCHAR}, '%'))
        </if>
    </sql>

    <!-- 条件查询 -->
    <select id="select" parameterType="com.berg.fastsearch.account.entity.Role"
            resultMap="com.berg.fastsearch.account.mapper.RoleMapper.BaseResultMap">
        SELECT
        <include refid="com.berg.fastsearch.account.mapper.RoleMapper.BaseSql">
            <property name="prefix" value="sr" />
        </include>
        FROM
        <include refid="com.berg.fastsearch.account.mapper.RoleMapper.TableName">
            <property name="alias" value="sr" />
        </include>
        <trim prefix="WHERE" prefixOverrides="AND |OR">
            <include refid="com.berg.fastsearch.account.mapper.RoleMapper.BaseCondition">
                <property name="prefix" value="sr"/>
            </include>
        </trim>
    </select>

    <select id="selectByPrimaryKey" parameterType="com.berg.fastsearch.account.entity.Role"
            resultMap="com.berg.fastsearch.account.mapper.RoleMapper.BaseResultMap">
        SELECT
        <include refid="com.berg.fastsearch.account.mapper.RoleMapper.BaseSql">
            <property name="prefix" value="sr" />
        </include>
        FROM
        <include refid="com.berg.fastsearch.account.mapper.RoleMapper.TableName">
            <property name="alias" value="sr" />
        </include>
        WHERE
        sr.ID = #{id, jdbcType=DECIMAL}
    </select>
</mapper>